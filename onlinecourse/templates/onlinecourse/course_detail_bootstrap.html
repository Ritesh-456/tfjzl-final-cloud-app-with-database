{% extends 'onlinecourse/base_bootstrap.html' %}

{% block content %}
<div class="container mt-4">

  <h2>{{ course.name }}</h2>
  <p>{{ course.description }}</p>

  <h4>Lessons</h4>
  <ul>
    {% for lesson in course.lesson_set.all %}
      <li><strong>{{ lesson.title }}</strong>: {{ lesson.content }}</li>
    {% empty %}
      <li>No lessons available.</li>
    {% endfor %}
  </ul>

  <hr>

  {% if user.is_authenticated %}
  <button class="btn btn-primary btn-block" data-toggle="collapse" data-target="#exam">
    Start Exam
  </button>

  <div id="exam" class="collapse mt-3">
    <form id="questionform" action="{% url 'onlinecourse:submit' course.id %}" method="POST">
      {% csrf_token %}

      {% for question in course.question_set.all %}
      <div class="card mt-2">
        <div class="card-header">
          <h5>{{ question.content }}</h5>
        </div>
        <div class="card-body">
          {% for choice in question.choice_set.all %}
          <div class="form-check">
            <label class="form-check-label">
              <input type="checkbox"
                     name="choice_{{ choice.id }}"
                     class="form-check-input"
                     value="{{ choice.id }}">
              {{ choice.content }}
            </label>
          </div>
          {% empty %}
            <p>No choices available for this question.</p>
          {% endfor %}
        </div>
      </div>
      {% empty %}
        <p>No questions available for this course.</p>
      {% endfor %}

      <button class="btn btn-success btn-block mt-3" type="submit">Submit Exam</button>
    </form>
  </div>
  {% else %}
    <p>Please log in to take the exam.</p>
  {% endif %}

</div>
{% endblock %}
